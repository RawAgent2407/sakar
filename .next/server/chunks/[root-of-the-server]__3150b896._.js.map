{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///Users/rawboy/Downloads/property-final--master/src/app/api/properties/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport mongoose from 'mongoose';\n\nconst MONGODB_URI = 'mongodb+srv://solankiish25:1234@cluster0.hvuwzyq.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0';\nconst DB_NAME = 'test';\n\nlet isConnected = false;\nasync function connectDB() {\n  if (isConnected) return;\n  await mongoose.connect(MONGODB_URI, { dbName: DB_NAME });\n  isConnected = true;\n}\n\nconst gallerySchema = new mongoose.Schema({\n  url: String, // for backward compatibility or external images\n  data: String, // base64 image data\n  name: String,\n}, { _id: false });\n\nconst videoSchema = new mongoose.Schema({\n  url: String,\n  name: String,\n}, { _id: false });\n\nconst keyHighlightsSchema = new mongoose.Schema({\n  reraApproved: Boolean,\n  reraNumber: { type: String, default: '' },\n  possessionDate: String,\n  unitConfiguration: String,\n  carpetArea: {\n    from: String,\n    to: String,\n    unit: { type: String, default: 'sqft' }\n  },\n  otherAmenities: [String],\n  igbcGoldCertified: Boolean,\n  igbcLevel: { type: String, enum: ['', 'Certified', 'Silver', 'Gold', 'Platinum'], default: '' },\n}, { _id: false });\n\nconst propertySchema = new mongoose.Schema({\n  name: String,\n  tagline: String,\n  propertyType: String,\n  location: String, // area\n  priceRange: {\n    from: {\n      value: String,\n      unit: { type: String, enum: ['Lac', 'Cr'], default: 'Lac' }\n    },\n    to: {\n      value: String,\n      unit: { type: String, enum: ['Lac', 'Cr'], default: 'Lac' }\n    }\n  },\n  builder: {\n    developerName: String,\n    websiteUrl: String,\n  },\n  keyHighlights: keyHighlightsSchema,\n  gallery: [gallerySchema],\n  videos: [videoSchema],\n  locationAdvantage: {\n    address: String,\n    addressUrl: String,\n    advantages: [String],\n  },\n  featuredDevelopment: {\n    text: String,\n    images: [gallerySchema],\n  },\n  otherProjects: [String],\n  trendingScore: Number,\n  featured: Boolean,\n  home: Boolean,\n  status: String,\n  createdAt: { type: Date, default: Date.now },\n  updatedAt: { type: Date, default: Date.now },\n});\n\nconst Property = mongoose.models.Property || mongoose.model('Property', propertySchema, 'properties');\n\nexport async function GET() {\n  try {\n    await connectDB();\n    const properties = await Property.find().sort({ createdAt: -1 });\n    return NextResponse.json({ success: true, properties });\n  } catch (error) {\n    return NextResponse.json({ success: false, message: 'Internal server error' }, { status: 500 });\n  }\n}\n\nexport async function POST(req: NextRequest) {\n  try {\n    await connectDB();\n    const data = await req.json();\n    console.log('POST /api/properties received data:', JSON.stringify(data, null, 2));\n    const property = await Property.create(data);\n    return NextResponse.json({ success: true, property });\n  } catch (error) {\n    console.error('Property POST error:', error);\n    return NextResponse.json({ success: false, message: 'Internal server error' }, { status: 500 });\n  }\n}\n\nexport async function PUT(req: NextRequest) {\n  try {\n    await connectDB();\n    const data = await req.json();\n    console.log('PUT /api/properties received data:', JSON.stringify(data, null, 2));\n    if (!data._id) return NextResponse.json({ success: false, message: 'Missing property ID' }, { status: 400 });\n    // If this property is being marked as home, unset 'home' for all others\n    if (data.home === true) {\n      await Property.updateMany({ _id: { $ne: data._id } }, { $set: { home: false } });\n    }\n    let updateQuery;\n    if (data.trendingScore === undefined || data.trendingScore === null || data.trendingScore === '') {\n      updateQuery = { $set: { ...data, updatedAt: new Date() }, $unset: { trendingScore: 1 } };\n    } else {\n      updateQuery = { $set: { ...data, updatedAt: new Date() } };\n    }\n    const property = await Property.findByIdAndUpdate(\n      data._id,\n      updateQuery,\n      { new: true }\n    );\n    return NextResponse.json({ success: true, property });\n  } catch (error) {\n    console.error('Property PUT error:', error);\n    return NextResponse.json({ success: false, message: 'Internal server error' }, { status: 500 });\n  }\n}\n\nexport async function DELETE(req: NextRequest) {\n  try {\n    await connectDB();\n    const { _id } = await req.json();\n    if (!_id) return NextResponse.json({ success: false, message: 'Missing property ID' }, { status: 400 });\n    await Property.findByIdAndDelete(_id);\n    return NextResponse.json({ success: true });\n  } catch (error) {\n    return NextResponse.json({ success: false, message: 'Internal server error' }, { status: 500 });\n  }\n} "],"names":[],"mappings":"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","debugId":null}}]
}